<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>疫苗預約</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { font-family: sans-serif; background:#f5f7fb; padding:20px; }
    .card { max-width:420px; margin:auto; background:#fff; padding:20px; border-radius:12px; }
    button { width:100%; padding:12px; background:#6fb98f; color:#fff; border:none; border-radius:8px; }
    input, select { width:100%; padding:10px; margin-bottom:10px; }
  </style>
</head>
<body>
<div class="card">
  <h3>疫苗預約</h3>

  <input id="vaccine" placeholder="疫苗項目" />
  <input id="date" type="date" />
  <select id="time">
    <option>09:00–09:30</option>
    <option>09:30–10:00</option>
    <option>10:00–10:30</option>
    <option>15:30–16:00</option>
    <option>16:30–17:00</option>
    <option>19:30–20:00</option>
    <option>20:00–20:30</option>
  </select>

  <input id="name" placeholder="姓名" />
  <input id="phone" placeholder="電話" />
  <input id="idCard" placeholder="身分證" />
  <input id="birthday" type="date" />

  <button onclick="send()">送出</button>
  <p id="msg"></p>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbxtA1h2KPLTuhAc6eQX4WD7g0RHwL-YYy669ZxLlYfUBdqdovmxb4S4IMsKViWzeCw/exec";
let lineId = "";

async function init() {
  await liff.init({ liffId: "2008795875-tZfdoVwR" });
  if (!liff.isLoggedIn()) liff.login();
  const p = await liff.getProfile();
  lineId = p.userId;
}
init();

async function send() {
  const data = {
    vaccine: vaccine.value,
    date: date.value,
    time: time.value,
    name: name.value,
    phone: phone.value,
    idCard: idCard.value,
    birthday: birthday.value,
    lineId
  };

  const res = await fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify(data)
  }).then(r => r.json());

  msg.innerText = res.ok ? "預約成功" : res.msg;
  if (res.ok) liff.closeWindow();
}
</script>
</body>
</html>
